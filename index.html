<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="/src/styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Imalink Desktop</title>
    <script type="module" src="/src/main.ts" defer></script>
  </head>

  <body>
    <main class="container">
      <h1>Imalink Desktop</h1>
      <p>Batch import av bilder til Imalink backend via imalink-core</p>

      <!-- Login Screen -->
      <div id="login-screen" style="display: none;">
        <div class="section">
          <h2>Logg inn</h2>
          <form id="login-form">
            <div class="controls">
              <label for="backend-url">Imalink Backend URL:</label>
              <input 
                type="text" 
                id="backend-url" 
                value="https://api.trollfjell.com" 
                placeholder="https://api.trollfjell.com"
              />
            </div>
            <div class="controls">
              <label for="login-username">Brukernavn:</label>
              <input 
                type="text" 
                id="login-username" 
                placeholder="brukernavn"
                autocomplete="username"
                required
              />
            </div>
            <div class="controls">
              <label for="login-password">Passord:</label>
              <input 
                type="password" 
                id="login-password" 
                placeholder="passord"
                autocomplete="current-password"
                required
              />
            </div>
            <div class="controls">
              <button type="submit" id="login-btn">Logg inn</button>
            </div>
            <div id="login-status"></div>
            <div class="auth-toggle">
              <p>Har du ikke konto? <a href="#" id="show-register">Registrer deg her</a></p>
            </div>
          </form>
        </div>

        <div class="section">
          <h2>Registrer ny bruker</h2>
          <form id="register-form" style="display: none;">
            <div class="controls">
              <label for="register-username">Brukernavn:</label>
              <input 
                type="text" 
                id="register-username" 
                placeholder="brukernavn"
                autocomplete="username"
                required
              />
            </div>
            <div class="controls">
              <label for="register-email">E-post:</label>
              <input 
                type="email" 
                id="register-email" 
                placeholder="din@epost.no"
                autocomplete="email"
                required
              />
            </div>
            <div class="controls">
              <label for="register-password">Passord:</label>
              <input 
                type="password" 
                id="register-password" 
                placeholder="passord"
                autocomplete="new-password"
                required
              />
            </div>
            <div class="controls">
              <label for="register-displayname">Visningsnavn:</label>
              <input 
                type="text" 
                id="register-displayname" 
                placeholder="Ditt Navn"
                required
              />
            </div>
            <div class="controls">
              <button type="submit" id="register-btn">Registrer bruker</button>
            </div>
            <div id="register-status"></div>
            <div class="auth-toggle">
              <p>Har du allerede konto? <a href="#" id="show-login">Logg inn her</a></p>
            </div>
          </form>
        </div>
      </div>

      <!-- Main Screen (after login) -->
      <div id="main-screen" style="display: none;">
        <div class="section">
          <div class="user-header">
            <span id="user-info"></span>
            <button id="logout-btn" class="logout-btn">Logg ut</button>
          </div>
        </div>

        <div class="section">
          <h2>1. API Konfiguration</h2>
          <div class="controls">
            <label for="core-url">imalink-core API URL:</label>
            <input 
              type="text" 
              id="core-url" 
              value="http://localhost:8765" 
              placeholder="http://localhost:8765"
            />
          </div>
        </div>

        <div class="section">
          <h2>2. Import Session Metadata</h2>
          <div class="controls">
            <label for="session-title">Tittel (valgfritt):</label>
            <input 
              type="text" 
              id="session-title" 
              placeholder="Eksempel: Italia Sommer 2024"
            />
          </div>
          <div class="controls">
            <label for="session-description">Beskrivelse (valgfritt):</label>
            <textarea 
              id="session-description" 
              rows="3"
              placeholder="Beskrivelse av importen..."
            ></textarea>
          </div>
          <p class="info-text">ðŸ“¸ Bildene vil automatisk knyttes til deg som fotograf</p>
        </div>

        <div class="section">
          <h2>3. Velg Katalog</h2>
          <div class="controls">
            <button id="select-dir">Velg katalog med bilder</button>
            <span id="selected-dir"></span>
          </div>
          <div id="file-list" style="display: none;">
            <h3>Funnet filer:</h3>
            <div id="files"></div>
          </div>
        </div>

        <div class="section">
          <h2>4. Start Import</h2>
          <div class="controls">
            <button id="start-import" disabled>Start Import</button>
          </div>
        </div>

        <div id="status"></div>
        
        <div id="progress" style="display: none;">
          <h2>Import Progress</h2>
          <div class="progress-bar">
            <div id="progress-fill"></div>
          </div>
          <div id="progress-text"></div>
        </div>

        <div id="results" style="display: none;">
          <h2>Import Results</h2>
          <div id="results-content"></div>
        </div>
      </div>
    </main>
  </body>
</html>
